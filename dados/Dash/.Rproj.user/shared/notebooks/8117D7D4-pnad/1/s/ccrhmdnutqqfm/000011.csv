"0",""
"0","dados_df <- dados_df %>%"
"0","  mutate("
"0","    faixa_renda = case_when("
"0","      is.na(rendimento_habitual) ~ NA_character_,"
"0","      rendimento_habitual <= 1500 ~ ""Até 1500"","
"0","      rendimento_habitual <= 3000 ~ ""1501 a 3000"","
"0","      TRUE ~ ""Acima de 3000"""
"0","    ),"
"0","    faixa_renda = factor(faixa_renda, levels = c(""Até 1500"", ""1501 a 3000"", ""Acima de 3000"")),"
"0","    # regex para remover os parênteses "
"0","    posição_trabalho_principal = str_replace(posição_trabalho_principal, "" \\(.*"", """")"
"0","  )"
"0",""
"0","variaveis_tabela <- c("
"0","  ""cor_raça"" = ""Cor ou Raça"","
"0","  ""nível_instrução"" = ""Nível de Instrução"","
"0","  ""numero_trabalhos"" = ""Número de Trabalhos"","
"0","  ""posição_trabalho_principal"" = ""Posição no Trabalho Principal"","
"0","  ""horas_trabalhadas_faixa"" = ""Faixa de Horas Trabalhadas"","
"0","  ""faixa_renda"" = ""Faixa de Renda"""
"0",")"
"0",""
"0","res3 <- list()"
"0",""
"0","for (v in names(variaveis_tabela)) {"
"0","  res3[[v]] <- dados_df %>%"
"0","    filter("
"0","      !is.na(.data[[v]]),"
"0","      !(v == ""cor_raça"" & .data[[v]] == ""Ignorado"")"
"0","    ) %>%"
"0","    group_by(Ano, categoria = .data[[v]]) %>%"
"0","    summarise(peso = sum(peso), .groups = ""drop"") %>%"
"0","    group_by(Ano) %>%"
"0","    mutate("
"0","      valor = round(100 * peso / sum(peso), 2),"
"0","      categoria = as.factor(categoria),"
"0","      variavel = variaveis_tabela[[v]]  # aplica nome legível"
"0","    ) %>%"
"0","    select(Ano, variavel, categoria, valor)"
"0","}"
"0",""
"0","tabela <- bind_rows(res3)"
"0",""
"0","tabela_final <- pivot_reorder(tabela, Ano, variavel, categoria, valor, c(""Cor/Raça"", ""Número de Trabalhos"", ""Posição no Trabalho Principal""), decrescente = TRUE)"
"0",""
"0","data.table(tabela_final)"
