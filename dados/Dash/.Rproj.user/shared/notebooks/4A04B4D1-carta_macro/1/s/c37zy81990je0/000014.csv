"0",""
"0","### PROJEÇÃO (FBCF e PIB)"
"0",""
"0","# 0. Preencher valores faltantes"
"0",""
"0","# Preencher apenas os valores após 2026-05-01 com a média móvel"
"0","expectativas <- expectativas %>%"
"0","  mutate("
"0","    taxa_de_desocupacao = ifelse("
"0","      date >= as.Date(""2026-05-01""),"
"0","      rollapply(taxa_de_desocupacao, width = 12, FUN = mean, na.rm = TRUE"
"0","      ),"
"0","      taxa_de_desocupacao"
"0","    )"
"0","  )"
"0",""
"0","# 1. Mesclar dados e expectativas"
"0","data_treino <- merge(dados, expectativas)"
"0",""
"0","# 2. Ajustar modelos de regressão linear"
"0","lm_model_FBCF <- lm(FBCF.dessaz ~ Câmbio + ipca + taxa_de_desocupacao, data = data_treino, na.action = na.exclude)"
"0","lm_model_PIB_precos_de_mercado <- lm(PIB_precos_de_mercado.dessaz ~ Câmbio + ipca + taxa_de_desocupacao, data = data_treino, na.action = na.exclude)"
"0",""
"0","# 3. Fazer projeções a partir de 2025 em diante"
"0",""
"0","expectativas_futuras <- expectativas %>% filter(date >= ""2025-01-01"")"
"0","expectativas_futuras$FBCF_proj <- predict(lm_model_FBCF, newdata = expectativas_futuras)"
"0","expectativas_futuras$PIB_precos_de_mercado_proj <- predict(lm_model_PIB_precos_de_mercado, newdata = expectativas_futuras)"
"0",""
"0","# 4. Conectar dados históricos e projeções"
"0",""
"0","# Adicionar a nova linha ao dataframe expectativas_futuras"
"0","expectativas_futuras <- expectativas_futuras %>%"
"0","  bind_rows("
"0","    data.frame("
"0","      date = as.Date(""2024-12-01""),"
"0","      FBCF_proj = dados$FBCF.dessaz[dados$date == ""2024-12-01""], #178.964"
"0","      PIB_precos_de_mercado_proj = dados$PIB_precos_de_mercado.dessaz[dados$date == ""2024-12-01""], #191.306"
"0","      Câmbio = NA,"
"0","      ipca = NA,"
"0","      taxa_de_desocupacao = NA"
"0","    )"
"0","  )"
"0",""
"0","# Calcular o R² Ajustado para os modelos"
"0","r2_adj_FBCF <- summary(lm_model_FBCF)$adj.r.squared"
"0","r2_adj_PIB <- summary(lm_model_PIB_precos_de_mercado)$adj.r.squared"
"0",""
"0","#5. Plotar os dados históricos e projeções"
"0",""
"0","grafico_projecoes <- ggplot(dados, aes(x = date)) +"
"0","  # Linhas históricas"
"0","  geom_line(aes(y = reindexar(FBCF.dessaz, dados, ""2024-12-01""), color = ""FBCF""), linewidth = 0.8, alpha = 1) +"
"0","  geom_line(aes(y = reindexar(PIB_precos_de_mercado.dessaz, dados, ""2024-12-01""), color = ""PIB""), linewidth = 0.8, alpha = 1) +"
"0","  # Linhas de projeção"
"0","  geom_line(data = expectativas_futuras, aes(y = reindexar(FBCF_proj, expectativas_futuras, ""2024-12-01""), color = ""FBCF""), linetype = ""F1"", alpha = 0.8, linewidth = 1) +"
"0","  geom_line(data = expectativas_futuras, aes(y = reindexar(PIB_precos_de_mercado_proj, expectativas_futuras, ""2024-12-01""), color = ""PIB""), linetype = ""F1"", alpha = 0.8, linewidth = 1) +"
"0","  # Adicionar estatísticas de R² Ajustado"
"0","  annotate(""text"", x = as.Date(""2027-01-01""), y = 102, label = paste(""R² Ajustado PIB:"", round(r2_adj_PIB, 3)), color = ""saddlebrown"") +"
"0","  labs("
"0","    title = ""Projeções de FBCF e PIB"","
"0","    x = NULL, y = ""2024 = 100"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""bottom"") +"
"0","  scale_x_date("
"0","    date_labels = ""%m.%y"", "
"0","    date_breaks = ""3 months"", "
"0","    limits = c(as.Date(""2022-01-01""), max(expectativas_futuras$date))"
"0","  ) +"
"0","  scale_color_manual("
"0","    values = c(""FBCF"" = ""darkgreen"", ""PIB"" = ""saddlebrown""),"
"0","    guide = guide_legend(title = NULL)  # Remove o título da legenda"
"0","  ) +"
"0","  scale_y_continuous("
"0","    limits = c(87.5, 102.5),"
"0","    breaks = c(90, 95, 100)"
"0","  )"
"0",""
